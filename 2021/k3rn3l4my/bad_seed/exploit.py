#!/usr/bin/env python3

from pwn import *
import ctypes

libc = ctypes.CDLL('/lib/x86_64-linux-gnu/libm.so.6')
binary = context.binary = ELF('./badseed')

if args.REMOTE:
    io = remote('ctf.k3rn3l4rmy.com', 2200)
else:
    io = process(binary.path)

# Question 1
io.recvline()
io.sendline(str(662).encode())
io.recvuntil(b'give me the rand() value\n')

# Question 2
libc.srand(libc.time(None))
number1 = libc.rand()
number2 = libc.rand()
io.sendline(str(number2).encode())
io.recvuntil(b'no hint this time... you can do it?!\n')

# Question 3
libc.srand(libc.time(None))
number1 = libc.rand()
libc.srand(number1)
number2 = libc.rand()
result = (number1 // number2) % 1000
io.sendline(str(result).encode())

io.interactive()
# flag{i_0_w1th_pwn70ols_i5_3a5y}
